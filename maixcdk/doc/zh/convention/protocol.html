<!DOCTYPE html>

<html lang="zh"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/maixcdk/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/maixcdk/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixcdk/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixcdk/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixcdk/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/maixcdk/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/maixcdk/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/maixcdk/static/css/search/style.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixcdk/static/css/custom.css" type="text/css"/>
        
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9cb07365544a53067c56c346c838181a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
        
        <link rel="stylesheet" href="/maixcdk/static/js/thumbs_up/style.css" type="text/css"/>
        
    
    
    <title>Maix communicate Protocol - MaixCDK</title>
    
    <script type="text/javascript">js_vars = {"teedoc-plugin-thumbs-up": {"label_up": "有帮助", "label_down": "待改进", "icon": "/static/images/thumbs_up/up.svg", "icon_clicked": "/static/images/thumbs_up/upped.svg", "url": "https://thumbs-up.sipeed.com", "show_up_count": true, "show_down_count": false, "msg_already_voted": "您已经投过票了", "msg_thanks": "感谢您的反馈", "msg_down_prompt": "感谢反馈，请告诉我们可以改进什么地方?（最少 10 个字）", "msg_down_prompt_error": "消息最少需要 10 个字， 最多 256 个字", "msg_error": "请求点赞服务器出现错误!"}}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": "2023-11-28", "update": [{"date": "2023-11-28", "author": "neucrack", "version": "1.0.0", "content": "设计并编写协议文档和代码 API 实现"}], "ts": 1701129600, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/maixcdk/">
                
                
                    <h2>MaixCDK</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class="active"><a  href="/maixcdk/doc/zh/">文档</a></li>
<li class=""><a  href="/maixcdk/api/">API</a></li>
<li class=""><a  href="/maixcdk/doc/zh/faq.html">FAQ</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/sipeed/MaixCDK"><img src='/maixcdk/static/image/github-fill.svg' style='height: 1.5em;vertical-align: middle;'>&nbsp;</a></li>
<li class="sub_items "><a  ><img src='/maixcdk/static/image/language.svg' style='height: 1.5em;vertical-align: middle;'>&nbsp;中文</a><ul><li class="active"><a  href="/maixcdk/doc/zh/convention/protocol.html">中文</a></li>
<li class=""><a  href="/maixcdk/doc/convention/protocol.html">English</a></li>
</ul></li>
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/maixcdk/doc/zh/index.html"><span class="label">快速开始</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/faq.html"><span class="label">FAQ 常见问题</span><span class=""></span></a></li>
<li class="active_parent no_link"><a><span class="label">规范</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/maixcdk/doc/zh/convention/index.html"><span class="label">编码规范</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/convention/add_api.html"><span class="label">添加新 API</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/convention/app.html"><span class="label">APP 框架</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/convention/i18n.html"><span class="label">I18N(国际化/多语言)</span><span class=""></span></a></li>
<li class="active with_link"><a href="/maixcdk/doc/zh/convention/protocol.html"><span class="label">Maix 通信协议</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/convention/nn.html"><span class="label">NN AI 模型</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/convention/memcheck.html"><span class="label">内存泄漏检测</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/dev/docker/index.html"><span class="label">Docker 环境</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/more.html"><span class="label">更多文档</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">应用笔记</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/maixcdk/doc/zh/application/index.html"><span class="label">关于本笔记</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/application/ai/yolo11.html"><span class="label">YOLO11 开发笔记</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixcdk/doc/zh/application/ui/lvgl.html"><span class="label">LVGL</span><span class=""></span></a></li>
</ul>
</li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>Maix communicate Protocol</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="最后修改日期： 2023-11-28">
                                    2023-11-28
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                            <div id="source_link">
                                <a href="https://github.com/sipeed/MaixCDK/blob/main/docs/doc_zh/convention/protocol.md" target="_blank">
                                    <span id='editPage'>编辑本页</span>
                                </a>
                            </div>
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                        
                        <details open>
                        
                            <summary>更新历史</summary>
                            <div>
                                <table>
                                        <thead>
                                            <tr>
                                                <th>日期</th>
                                                <th>版本</th>
                                                <th>作者</th>
                                                <th>更新内容</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            
                                                <tr>
                                                    <td>2023-11-28</td>
                                                    <td>1.0.0</td>
                                                    <td>neucrack</td>
                                                    <td>
                                                    
                                                        设计并编写协议文档和代码 API 实现
                                                    
                                                    </td>
                                                </tr>
                                            
                                        </tbody>
                                </table>
                            </div>
                        </details>
                        
                    </div>
                    <div id="article_content">
                        
                            <h2 id="Maix-%E4%B8%B2%E5%8F%A3%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B">Maix 串口协议简介</h2>
<p>运行 MaixCDK 或者 MaixPy 的设备， 除了可以直接使用设备上的触摸屏和按键操作外， 还可以作为模块，可以使用 <code>UART</code>（串口） 或者 <code>I2C</code> 进行通信控制。</p>
<blockquote>
<p>因为 I2C 为主从模式，所以协议都采用问答模式，一问一答，即<code>Request</code>+<code>Response</code><br />
对于 UART 协议， 部分功能支持配置主动上报，具体请看协议</p>
</blockquote>
<p>后文会详细阐述通信协议内容。</p>
<h2 id="Maix-%E8%AE%BE%E5%A4%87%E7%AB%AF%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8">Maix 设备端如何使用</h2>
<p>开机进入 <code>设置</code> 应用，在 <code>通信</code> 设置里面选择通信接口，有：</p>
<ul>
<li><strong>串口</strong>：选择后会使用串口进行通信，串口根据板子决定，波特率默认为<code>115200</code>。</li>
<li><strong>TCP</strong>：选择后 Maix 设备会启动一个 TCP 服务，主控端可以通过 TCP 连接 Maix 设备，端口默认为<code>5555</code>。</li>
</ul>
<p>然后主控连接上 Maix 设备后，就可以通过协议进行通信了， 主控作为主设备， Maix 设备作为从设备。</p>
<p><strong>Maix 设备端开发</strong>：</p>
<p>用提供的<code>maix.comm.CommProtocol</code>类可以很方便实现命令响应，具体参考例程 <a href="../../../examples/protocol_demo"  >comm_protocol</a>（C++）或者 <a href="https://github.com/sipeed/MaixPy/blob/main/examples/protocol"  target="_blank">comm_protocol.py</a>（MaixPy）。</p>
<p><strong>主控端开发</strong>：</p>
<p>主控端根据芯片和开发语言可自行实现协议，在文末附录中有提供模板代码。</p>
<h2 id="%E6%95%B0%E6%8D%AE%E5%B8%A7">数据帧</h2>
<table>
<thead>
<tr>
  <th></th>
  <th>header(4B LE)</th>
  <th>data len(4B LE)(flags+cmd+body+crc)</th>
  <th>flags(1B)</th>
  <th>cmd(1B)</th>
  <th>body(nB)</th>
  <th>CRC16_IBM(2B LE)(前面所有)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>十进制示例</td>
  <td>3148663466</td>
  <td>9</td>
  <td>0</td>
  <td>1</td>
  <td>hello</td>
  <td>17451</td>
</tr>
<tr>
  <td>十六进制示例</td>
  <td>0xBBACCAAA</td>
  <td>0x00000009</td>
  <td>0x00</td>
  <td>0x01</td>
  <td>hello</td>
  <td>0x442B</td>
</tr>
<tr>
  <td>字节流(十六进制)</td>
  <td>AA CA AC BB</td>
  <td>09 00 00 00</td>
  <td>00</td>
  <td>01</td>
  <td>68 65 6c 6c 6F</td>
  <td>2B 44</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>注意</strong>这里超过一个字节的数据均采用小端(LE)编码，比如这里 <code>data_len</code> 为 <code>0x00000006</code>，<code>06</code>在最低位，发送时需要先发送<code>0x06</code>再发送<code>0x00</code> <code>0x00</code> <code>0x00</code>。<br />
字符串就按照顺序发即可，比如<code>hello</code>，先发<code>h</code>再发<code>e</code> <code>l</code> <code>l</code> <code>o</code>。<br />
这里的例子，最终发送数据： <code>AA CA AC BB 09 00 00 00 00 01 68 65 6c 6c 6F 2B 44</code>。</p>
</blockquote>
<ul>
<li><code>header</code>: 头，4 字节，用来标识一帧的开始，固定为 4 字节 <code>0xAA 0xCA 0xAC 0xBB</code>, 先发<code>0xAA</code></li>
<li><code>data len</code>: 数据长度， 4 字节， 包含了 <code>flags</code> <code>cmd</code> + <code>body</code> + <code>CRC</code> 的长度。</li>
<li><code>flags</code>: 一个字节，各个位分别表示：<ul>
<li>最高位 <code>is_resp</code>:  是否是响应，<code>0</code>代表发送请求，<code>1</code>代表 响应 或者 主动上报（第三高位需要置<code>1</code>）。</li>
<li>第二高位 <code>resp_ok</code>:<ul>
<li>对于请求，保留位。</li>
<li>对于响应，<code>1</code>表示成功，<code>0</code>表示失败。</li>
</ul>
</li>
<li>第三高位 <code>is_report</code>：<ul>
<li>对于请求，保留位。</li>
<li>对于响应，<code>1</code>表示主动上报，<code>0</code>表示为响应消息。</li>
</ul>
</li>
<li>第 4~6 高位： 保留以后使用。</li>
<li>低 2位 <code>version</code>: 协议版本，以后修改不兼容的协议才会更改这个版本号，如果修改协议后与当前版本协议兼容则这个版本号不需要升级。目前的版本为 <code>1</code>。</li>
</ul>
</li>
<li><code>cmd</code>: 基本命令类型，1 字节，已经预先定义了几个命令，看后文<a href="#%E5%91%BD%E4%BB%A4%E5%AE%9A%E4%B9%89"  >命令定义</a>，这些预定义命令的值从 255 逐渐递减，APP 自定义的命令可以从 <code>0 ~ maix.protocol.CMD.CMD_APP_MAX</code>。</li>
<li><code>body</code>: 内容，变长, 长度只要 <code>&lt; (2^32 - 1)</code> 即可，不同的命令对应不同的<code>body</code>，在后面会对每个命令进行详细说明</li>
<li><code>crc16</code>: CRC 校验值，2 字节， 用以校验帧数据在传输过程中是否出错，使用 <code>CRC IBM</code> 方法计算，可以参见<a href="#C-CRC16"  >C 代码实现</a>，或者 <a href="#Python-CRC16"  >Python CRC16</a>。和<code>data_len</code>同样两个字节小端存放，传输时先传输低位再传输高位。</li>
</ul>
<p>编解码的代码见<a href="#%E9%99%84%E5%BD%95%EF%BC%9A%E4%BB%A3%E7%A0%81"  >附录：代码</a></p>
<h2 id="%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94">请求和响应</h2>
<h3 id="%E5%8F%91%E9%80%81%E6%96%B9%E4%B8%BB%E5%8A%A8%E8%AF%B7%E6%B1%82">发送方主动请求</h3>
<p>数据方向为： 单片机或其它主控设备 -&gt; Maix 设备</p>
<p><code>flags</code>最高位<code>is_resp</code>设置为<code>0</code>， <code>body</code> 内容由<code>cmd</code>决定;</p>
<h3 id="%E6%8E%A5%E6%94%B6%E6%96%B9%E5%93%8D%E5%BA%94">接收方响应</h3>
<p>数据方向为： Maix 设备 -&gt; 单片机或其它主控设备</p>
<p><code>flags</code>最高位<code>is_resp</code>设置为<code>1</code>。</p>
<ul>
<li>对于成功响应：<code>resp_ok</code> 设置为 <code>1</code>, <code>body</code> 内容由<code>cmd</code>决定, 其中最简单的成功响应即 <code>body</code> 为空。</li>
<li>对是失败响应：<ul>
<li><code>resp_ok</code>设置为 <code>0</code>。</li>
<li><code>body</code> 第一个字节为错误码, 具体的错误码见<a href="../../../components/basic/include/maix_err.hpp"  >MaixCDK maix.err.Err</a>。</li>
<li><code>body</code> 后面的字节为错误字符串信息，<code>UTF-8</code> 编码，一般情况下建议用纯英文，提高兼容性。</li>
</ul>
</li>
</ul>
<p>每个请求均应有对应的响应，即执行成功或者失败，后文均用<code>RESP_OK</code>和<code>RESP_ERR</code>来代替执行成功和失败两种响应。<br />
<code>RESP_OK</code>的 <code>body</code> 字节不说明就是没有，有会单独进行说明。</p>
<h3 id="%E4%B8%BB%E5%8A%A8%E4%B8%8A%E6%8A%A5%E6%95%B0%E6%8D%AE">主动上报数据</h3>
<p>数据方向为： Maix 设备 -&gt; 单片机或其它主控设备</p>
<p>需要主控先通过<code>CMD_SET_REPORT</code>命令设置需要主动上报的数据（需要对应的命令支持）</p>
<blockquote>
<p>比如 APP 支持 <code>CMD_GET_TEMP</code> 命令获取温度，主控可以通过 <code>CMD_SET_REPORT</code> 命令设置主动定时上报温度，然后 APP 收到这个命令后，就会定时上报温度，如果 APP 不支持设置<code>CMD_GET_TEMP</code>命令的主动上报，则会响应<code>CMD_ERROR</code>。</p>
</blockquote>
<p><code>flags</code>最高位<code>is_resp</code>设置为<code>1</code>，第三位<code>is_report</code> 设置为 <code>1</code>，<code>body</code> 内容由<code>cmd</code>决定。</p>
<h2 id="%E5%AE%9E%E4%BE%8B">实例</h2>
<p>举例：</p>
<p>单片机与 Maix 设备通过串口连接，默认使用<code>115200</code>波特率。</p>
<p>单片机向 Maix 设备请求获取 应用列表，步骤：</p>
<ol>
<li>根据下方的协议说明，单片机通过串口发送<code>cmd</code>为<code>0xF9</code>的请求，即<code>CMD_APP_LIST</code>，<code>body</code>为空。实际字节流：</li>
</ol>
<p><code>AA CA AC BB 04 00 00 00 01 F9 C9 77</code>。</p>
<ol start="2">
<li>Maix 设备收到请求后，返回<code>cmd</code>为<code>0xF9</code>, <code>flags</code>为<code>0x01 | 0x80 | 0x40 =&gt; 0xC1</code>的响应（响应<code>flags</code>最高为<code>1</code>所以有<code>|0x80</code>, 成功响应第二高位为<code>1</code>所以有<code>|0x40</code>），<code>body</code>内容为应用列表，具体内容见下方协议说明。假如有两个 APP,实际字节流：</li>
</ol>
<p><code>AA CA AC BB 0A 00 00 00 C1 F9 02 66 61 63 65 00 66 61 63 65 00 F6 06</code>。</p>
<h2 id="%E5%91%BD%E4%BB%A4%E5%AE%9A%E4%B9%89%E5%92%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4">命令定义和系统命令</h2>
<p>协议帧中的<code>cmd</code>取值如下：</p>
<table>
<thead>
<tr>
  <th>命令名</th>
  <th>值</th>
  <th>含义</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_APP_MAX</td>
  <td>0xC8</td>
  <td>应用可自定义命令最大值（不含）</td>
</tr>
<tr>
  <td>CMD_SET_REPORT</td>
  <td>0xF8</td>
  <td>设置主动上报</td>
</tr>
<tr>
  <td>CMD_APP_LIST</td>
  <td>0xF9</td>
  <td>应用列表查询</td>
</tr>
<tr>
  <td>CMD_START_APP</td>
  <td>0xFA</td>
  <td>启动应用</td>
</tr>
<tr>
  <td>CMD_EXIT_APP</td>
  <td>0xFB</td>
  <td>退出应用</td>
</tr>
<tr>
  <td>CMD_CUR_APP_INFO</td>
  <td>0xFC</td>
  <td>当前应用信息查询</td>
</tr>
<tr>
  <td>CMD_APP_INFO</td>
  <td>0xFD</td>
  <td>应用信息查询</td>
</tr>
<tr>
  <td>CMD_KEY</td>
  <td>0xFE</td>
  <td>按键模拟消息</td>
</tr>
<tr>
  <td>CMD_TOUCH</td>
  <td>0xFF</td>
  <td>触摸模拟消息</td>
</tr>
</tbody>
</table>
<p>这里指定的命令都是系统命令，每个应用可以根据自身的功能特性自定义命令。<br />
比如 在<code>相机</code>应用中，我们可以自定义<code>0x01</code>为拍照命令, <code>0x02</code>为闪光灯设置；在<code>分类器</code>应用中，我们自定义<code>0x01</code>为识别物体命令；<br />
也就是说<code>应用命令</code>制定应该遵循：</p>
<ul>
<li>对于每个应用来说命令都是独立的，当进入了一个应用，就要遵循应用制定的命令规则。比如一个应用使用了 <code>0x01</code> 命令， 另一个仍然可以用<code>0x01</code>。</li>
<li>任何 APP 自定义的命令都应该在<code>0 ~ CMD_APP_MAX</code>之间，包含<code>0</code>，不包含<code>CMD_APP_MAX</code>，保留系统命令。</li>
<li>应该在应用使用说明文档中详细说明每个命令的定义和作用。</li>
</ul>
<p>不同的<code>cmd</code>对应不同的请求和响应数据， 以及不同的<code>body</code>，详细协议（主要阐述<code>cmd</code>和<code>body</code>）如下：</p>
<h3 id="CMD_SET_REPORT">CMD_SET_REPORT</h3>
<p>开启或关闭命令主动上报。<br />
主动上报包括：</p>
<ol>
<li>有事件时主动上报，比如检测到人脸时主动上报人脸信息。</li>
<li>定时上报，比如每隔 5s 上报一次温度。</li>
</ol>
<p>如果定时上报和事件上报同时开启，则事件上报后，定时器重新计时。</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code>：</p>
<table>
<thead>
<tr>
  <th></th>
  <th>cmd(1B)</th>
  <th>on_off(1B)</th>
  <th>event(1B)</th>
  <th>timer(4B)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>解释</td>
  <td>需要开启主动上报的命令</td>
  <td>开关(1 开， 0 关)</td>
  <td>事件上报（1 开， 0 关）</td>
  <td>定时上报，单位 ms，不需要定时则设置为 0</td>
</tr>
<tr>
  <td>例子</td>
  <td>0x02</td>
  <td>0x01</td>
  <td>5000</td>
  <td></td>
</tr>
</tbody>
</table>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p>如果相应的命令支持主动上报，则响应<code>RESP_OK</code>，否则响应<code>RESP_ERR</code>，均由应用自行决定。</p>
<p><code>body</code>： 无</p>
<h3 id="CMD_APP_LIST">CMD_APP_LIST</h3>
<p>获取应用列表</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code> 为空</p>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>:</p>
<table>
<thead>
<tr>
  <th></th>
  <th>number(1B)</th>
  <th>app1</th>
  <th>...</th>
  <th>app n info</th>
</tr>
</thead>
<tbody>
<tr>
  <td>解释</td>
  <td>应用数量</td>
  <td>id1 + '\0'结尾的字符串</td>
  <td>...</td>
  <td>idn</td>
</tr>
<tr>
  <td>例子</td>
  <td>0x02</td>
  <td>'face\0'</td>
  <td>...</td>
  <td>'appn\0'</td>
</tr>
</tbody>
</table>
<h3 id="CMD_CUR_APP_INFO">CMD_CUR_APP_INFO</h3>
<p>获取当前应用信息</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code> 为空</p>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>:</p>
<table>
<thead>
<tr>
  <th></th>
  <th>idx(1B)</th>
  <th>app info(id + name + brief)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>解释</td>
  <td>应用序号</td>
  <td>应用信息（id， 名字(UTF-8 编码)，简介（UTF-8 编码））</td>
</tr>
<tr>
  <td>例子</td>
  <td>0x00</td>
  <td>'face\0face\0face detect\0'</td>
</tr>
</tbody>
</table>
<h3 id="CMD_APP_INFO">CMD_APP_INFO</h3>
<p>获取指定应用信息</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code> ：</p>
<table>
<thead>
<tr>
  <th></th>
  <th>idx(1B)</th>
  <th>app_id(nB)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>解释</td>
  <td>应用序号</td>
  <td>应用 ID</td>
</tr>
<tr>
  <td>例子</td>
  <td>0x02</td>
  <td>'face'</td>
</tr>
</tbody>
</table>
<p><code>idx</code> 和 <code>app_id</code> 二选一即可</p>
<ul>
<li><code>idx</code>: 应用序号（从0开始），设置为 0xFF 表示不设置</li>
<li><code>app_id</code>: 应用 ID，如果 idx 设置了，可以不用设置</li>
</ul>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>:</p>
<table>
<thead>
<tr>
  <th></th>
  <th>idx(1B)</th>
  <th>app info(id + name + brief)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>解释</td>
  <td>应用序号</td>
  <td>应用信息（id， 名字(UTF-8 编码)，简介（UTF-8 编码））</td>
</tr>
<tr>
  <td>例子</td>
  <td>0x00</td>
  <td>'face\0face\0face detect\0'</td>
</tr>
</tbody>
</table>
<h3 id="CMD_START_APP">CMD_START_APP</h3>
<p>请求启动指定应用，执行此命令会退出当前应用，然后启动指定应用。</p>
<ul>
<li>如果是 APP 收到这个命令，则它需要调用 API <code>maix.app.switch_app</code> 切换 APP。</li>
</ul>
<blockquote>
<p>这里存在一个风险，就是如果 APP 没有正确实现响应这个命令，则可以敦促开发者实现这个命令。</p>
</blockquote>
<ul>
<li>如果时 Launcher 收到这个命令后会启动对应的应用。</li>
</ul>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code>：</p>
<table>
<thead>
<tr>
  <th></th>
  <th>idx(1B)</th>
  <th>app_id(nB)</th>
  <th>app_func(nB)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>解释</td>
  <td>应用序号（从0开始），设置为 0xFF 表示不设置</td>
  <td>应用 ID，如果 idx 设置了，可以不用设置</td>
  <td>该应用存在多个功能时用于指定应用启动时执行的功能</td>
</tr>
<tr>
  <td>例子</td>
  <td>0x02</td>
  <td>'scan'</td>
  <td>'qrcode'</td>
</tr>
</tbody>
</table>
<p><code>idx</code> 、 <code>app_id</code> 和 <code>app_func</code> 三个参数如何使用：</p>
<ul>
<li><p>不带参数启动应用: 单独设置 <code>idx</code> 或者 <code>app_id</code></p>
</li>
<li><p>带参数启动应用:</p>
<blockquote>
<p><code>idx</code> + <code>app_func</code>，设置 <code>idx</code> 后，解释器会将后续的第一个字符串视为 <code>app_func</code>，如果有多个字符串将会返回错误。</p>
</blockquote>
<blockquote>
<p><code>app_id</code> + <code>app_func</code>，不设置 <code>idx</code>，解释器会在后续字符串中查找 <code>app_id</code> 和 <code>app_func</code>，不符合条件将会返回错误。</p>
</blockquote>
</li>
</ul>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>: 无</p>
<h3 id="CMD_EXIT_APP">CMD_EXIT_APP</h3>
<p>请求退出当前应用</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p>无 <code>body</code></p>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>: 无</p>
<h3 id="CMD_KEY">CMD_KEY</h3>
<p>发送模拟按键请求</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code>：</p>
<table>
<thead>
<tr>
  <th>key(4B)</th>
  <th>value(1B)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>键值(小端)</td>
  <td>取值：0x01(/0x00/0x02)</td>
</tr>
</tbody>
</table>
<ul>
<li><code>key</code>: 键值，4 字节，发送时需要按小端编码，比如<code>0x00000001</code> 发送时的字节流为<code>0x01 0x00 0x00 0x00</code>，支持的取值为：<ul>
<li>38: &quot;up&quot;</li>
<li>40: &quot;down&quot;</li>
<li>37: &quot;left&quot;</li>
<li>39: &quot;right&quot;</li>
<li>108: &quot;enter&quot;</li>
<li>27: &quot;esc&quot;</li>
<li>0x01010101: &quot;ok&quot;</li>
<li>0x02020202: &quot;ret&quot;</li>
<li>0x03030303: &quot;pre&quot;</li>
<li>0x04040404: &quot;next&quot;</li>
</ul>
</li>
<li><code>value</code>: 按键值， 1 字节<ul>
<li>0x01: 按下</li>
<li>0x00: 释放</li>
<li>0x02: 长按</li>
</ul>
</li>
</ul>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>: 无</p>
<h3 id="CMD_TOUCH">CMD_TOUCH</h3>
<p>发送模拟触摸请求</p>
<h4 id="%E8%AF%B7%E6%B1%82">请求</h4>
<p><code>body</code>：</p>
<table>
<thead>
<tr>
  <th>x</th>
  <th>y</th>
  <th>event(1B)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>x 坐标</td>
  <td>y 坐标</td>
  <td>事件</td>
</tr>
</tbody>
</table>
<p>event 取值：</p>
<ul>
<li>0x00: 按下</li>
<li>0x01: 抬起</li>
<li>0x02: 移动</li>
</ul>
<h4 id="%E5%93%8D%E5%BA%94">响应</h4>
<p><code>body</code>：无</p>
<h2 id="%E5%BA%94%E7%94%A8%EF%BC%88APPS%EF%BC%89%E5%8D%8F%E8%AE%AE%E8%AF%B4%E6%98%8E">应用（APPS）协议说明</h2>
<p>这里使用几个应用举例，<strong>注意不一定为应用真实命令规范</strong>，具体请看对应的<strong>应用说明文档</strong>。</p>
<p>如果应用支持 Maix 通信协议，一般会在说明文档中说明命令规范，没有说明可以认为没有，不过一般也仍然可以使用系统指令。</p>
<p>应用说明文档一般在：</p>
<ul>
<li><a href="https://maixhub.com/app"  target="_blank">MaixHub应用中心</a>，直接找到对应应用查看主页即可。</li>
<li>源码仓库：<ul>
<li>网友开源的： 可以在对应的开源仓库看到。</li>
<li>官方开源的基于 MaixCDK 的应用：在<a href="https://github.com/sipeed/MaixCDK/tree/main/projects"  target="_blank">MaixCDK/projects</a> 对应目录可以看到。</li>
<li>官方开源的基于 MaixPy 的应用：在<a href="https://github.com/sipeed/MaixPy/tree/main/projects"  target="_blank">MaixPy/projects</a> 对应目录可以看到。</li>
</ul>
</li>
</ul>
<h3 id="%E7%9B%B8%E6%9C%BA">相机</h3>
<p>命令:</p>
<table>
<thead>
<tr>
  <th>命令</th>
  <th>取值</th>
  <th>含义</th>
  <th>响应</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_SNAP</td>
  <td>0x01</td>
  <td>拍照</td>
  <td></td>
</tr>
</tbody>
</table>
<h3 id="%E5%88%86%E7%B1%BB%E5%99%A8">分类器</h3>
<p><strong>注意只是举例</strong>，真实协议请看对应<a href="https://github.com/sipeed/MaixCDK/tree/main/projects/app_camera"  target="_blank">应用</a> 介绍。</p>
<p><code>body</code>说明：<br />
请求只有一个字节， 代表了命令， 具体如下表：</p>
<table>
<thead>
<tr>
  <th>命令</th>
  <th>取值</th>
  <th>含义</th>
  <th>响应</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_RECOGNIZE</td>
  <td>0x01</td>
  <td>识别物体</td>
  <td>CMD_APP_CMD</td>
</tr>
</tbody>
</table>
<p>响应：</p>
<ul>
<li>命令 <code>CMD_RECOGNIZE</code> 的响应： 响应 <code>cmd</code>为 <code>CMD_APP_CMD</code>, <code>body</code>:</li>
</ul>
<table>
<thead>
<tr>
  <th>CMD_RECOGNIZE</th>
  <th>id(2B uint16 LE)</th>
  <th>prob(4B float LE)</th>
  <th>name</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_RECOGNIZE 值</td>
  <td>识别到的 id（下标），小端</td>
  <td>概率， 浮点型， 小端</td>
  <td>名字， UTF-8 编码</td>
</tr>
</tbody>
</table>
<h3 id="%E4%BA%BA%E8%84%B8%E5%92%8C%E4%BA%BA%E8%84%B8%E5%85%B3%E9%94%AE%E7%82%B9%E6%A3%80%E6%B5%8B">人脸和人脸关键点检测</h3>
<p><strong>注意只是举例</strong>，真实协议请看对应<a href="https://github.com/sipeed/MaixPy/tree/main/projects/app_face_landmarks"  target="_blank">应用</a> 介绍。</p>
<p><code>body</code>说明：<br />
请求只有一个字节， 代表了命令， 具体如下表：</p>
<table>
<thead>
<tr>
  <th>命令</th>
  <th>取值</th>
  <th>含义</th>
  <th>响应</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_POS</td>
  <td>0x01</td>
  <td>检测人脸</td>
  <td>CMD_APP_CMD</td>
</tr>
</tbody>
</table>
<p>响应：</p>
<ul>
<li>命令 <code>CMD_POS</code> 的响应： 响应 <code>cmd</code>为 <code>CMD_APP_CMD</code>, <code>body</code>:</li>
</ul>
<table>
<thead>
<tr>
  <th>CMD_POS</th>
  <th>face num(2B LE)</th>
  <th>prob(4B float LE)</th>
  <th>x(2B LE)</th>
  <th>y(2B LE)</th>
  <th>w(2B LE)</th>
  <th>h(2B LE)</th>
  <th>...</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_POS 值</td>
  <td>检测到的人脸数量</td>
  <td>概率， 浮点型， 小端</td>
  <td>人脸框左上角横坐标</td>
  <td>人脸框左上角纵坐标</td>
  <td>人脸框宽</td>
  <td>人脸框高</td>
  <td>剩下的人脸...</td>
</tr>
</tbody>
</table>
<h3 id="%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB">人脸识别</h3>
<p><strong>注意只是举例</strong>，真实协议请看对应<a href="https://github.com/sipeed/MaixPy/tree/main/projects/app_face_recognizer"  target="_blank">应用</a> 介绍。</p>
<p><code>body</code>说明：<br />
请求只有一个字节， 代表了命令， 具体如下表：</p>
<table>
<thead>
<tr>
  <th>命令</th>
  <th>取值</th>
  <th>含义</th>
  <th>响应</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_FACES</td>
  <td>0x01</td>
  <td>识别人脸</td>
  <td>CMD_APP_CMD</td>
</tr>
<tr>
  <td>CMD_USERS</td>
  <td>0x02</td>
  <td>查询所有用户</td>
  <td>CMD_APP_CMD</td>
</tr>
<tr>
  <td>CMD_RECORD</td>
  <td>0x03</td>
  <td>录入人脸</td>
  <td>CMD_APP_CMD</td>
</tr>
<tr>
  <td>CMD_REMOVE</td>
  <td>0x04</td>
  <td>删除人脸</td>
  <td>CMD_APP_CMD</td>
</tr>
</tbody>
</table>
<p>请求</p>
<p><code>CMD_APP_CMD</code>加一个字节的<code>app_cmd</code>，个别命令有额外的参数，如下：</p>
<ul>
<li>命令 <code>CMD_RECORD</code> 的请求</li>
</ul>
<table>
<thead>
<tr>
  <th>CMD_RECORD</th>
  <th>user name</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_RECORD 值</td>
  <td>录制的用户名</td>
</tr>
</tbody>
</table>
<ul>
<li>命令 <code>CMD_REMOVE</code> 的请求</li>
</ul>
<table>
<thead>
<tr>
  <th>CMD_REMOVE</th>
  <th>user idx(2B int16)</th>
  <th>user name</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_REMOVE 值</td>
  <td>用户下标， 两字节，小端</td>
  <td>要删除的用户名</td>
</tr>
</tbody>
</table>
<p>下标和用户名二选一</p>
<p>响应：</p>
<ul>
<li>命令 <code>CMD_FACES</code> 的响应： 响应 <code>cmd</code>为 <code>CMD_APP_CMD</code>, <code>body</code>:</li>
</ul>
<table>
<thead>
<tr>
  <th>CMD_FACES</th>
  <th>face num(2B LE)</th>
  <th>id(2B)</th>
  <th>name_len(1B)</th>
  <th>name</th>
  <th>prob(4B float LE)</th>
  <th>x(2B LE)</th>
  <th>y(2B LE)</th>
  <th>w(2B LE)</th>
  <th>h(2B LE)</th>
  <th>...</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_FACES 值</td>
  <td>检测到的人脸数量</td>
  <td>人脸 ID（下标）</td>
  <td>名字长度</td>
  <td>名字， UTF-8 编码</td>
  <td>概率， 浮点型， 小端</td>
  <td>人脸框左上角横坐标</td>
  <td>人脸框左上角纵坐标</td>
  <td>人脸框宽</td>
  <td>人脸框高</td>
  <td>剩下的人脸...</td>
</tr>
</tbody>
</table>
<ul>
<li>命令 <code>CMD_USERS</code> 的响应： 响应 <code>cmd</code>为 <code>CMD_APP_CMD</code>, <code>body</code>:</li>
</ul>
<table>
<thead>
<tr>
  <th>CMD_USERS</th>
  <th>user num(2B LE)</th>
  <th>name_len(1B)</th>
  <th>name</th>
  <th>...</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CMD_USERS 值</td>
  <td>用户数量</td>
  <td>用户名长度</td>
  <td>名字， UTF-8 编码</td>
  <td>剩下的用户名...</td>
</tr>
</tbody>
</table>
<ul>
<li><p>命令 <code>CMD_RECORD</code> 的响应： <code>CMD_OK</code> 或者 <code>CMD_ERROR</code></p>
</li>
<li><p>命令 <code>CMD_REMOVE</code> 的响应： <code>CMD_OK</code> 或者 <code>CMD_ERROR</code></p>
</li>
</ul>
<h2 id="MaixPy-%E4%B8%AD%E4%BD%BF%E7%94%A8-Maix-%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE">MaixPy 中使用 Maix 通信协议</h2>
<p>MaixPy 中已经将协议的解析和发送封装在<code>maix.comm.protocol</code> 和 <code>maix.comm.CommProtocol</code> 中了，使用起来很方便。</p>
<p>请看<a href="https://wiki.sipeed.com/maixpy/doc/zh/comm/maix_protocol.html"  target="_blank">MaixPy 文档</a> 进行详细了解。</p>
<h2 id="MaixCDK-%E4%B8%AD%E4%BD%BF%E7%94%A8-Maix-%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE">MaixCDK 中使用 Maix 通信协议</h2>
<p>建议先看上面的 MaixPy 使用文档，在 MaixPy 中成功使用后再尝试 MaixCDK，用法一致。</p>
<p>注意如果你的应用没有使用<code>maix::comm::CommProtocol</code> 进行自定义命令，建议在程序开头调用一下</p>

<pre class="language-c++"><code class="language-c++">maix::comm::add_default_comm_listener();
</code></pre>
<p>这个函数会自动开一个线程监听系统指令，这样你的应用就支持系统指令了比如通过串口启动和退出你的应用。</p>
<h2 id="%E9%99%84%E5%BD%95%EF%BC%9A%E6%96%B9%E4%BE%BF%E7%A7%BB%E6%A4%8D%E5%88%B0%E5%85%B6%E5%AE%83%E4%B8%BB%E6%8E%A7%E7%9A%84%E4%BB%A3%E7%A0%81">附录：方便移植到其它主控的代码</h2>
<p>如果你不是在 MaixCDK / MaixPy 中使用协议时，比如 MaixCAM 外接了一个 STM32 来进行通信，下面的代码方便你快速移植到 STM32 等其它设备。</p>
<h3 id="%E5%8F%82%E8%80%83-MaixCDK-%E6%BA%90%E7%A0%81">参考 MaixCDK 源码</h3>
<p>MaixCDK 开源了 Maix 通信协议的代码，可以参考:</p>
<ul>
<li><a href="https://github.com/sipeed/MaixCDK/blob/main/components/basic/include/maix_protocol.hpp"  target="_blank">maix_protocol.hpp</a></li>
<li><a href="https://github.com/sipeed/MaixCDK/blob/main/components/basic/src/maix_protocol.cpp"  target="_blank">maix_protocol.cpp</a></li>
</ul>
<p>可以关注 <code>encode</code> 和 <code>get_msg</code> 函数，根据你的平台进行移植。</p>
<h3 id="C-CRC16-IBM">C CRC16 IBM</h3>

<pre class="language-c"><code class="language-c">unsigned short crc16_IBM(unsigned char *ptr, int len)
{
    unsigned int i;
    unsigned short crc = 0x0000;

    while(len--)
    {
        crc ^= *ptr++;
        for (i = 0; i &lt; 8; ++i)
        {
            if (crc &amp; 1)
                crc = (crc &gt;&gt; 1) ^ 0xA001;
            else
                crc = (crc &gt;&gt; 1);
        }
    }

    return crc;
}
</code></pre>
<p>或者查表法：</p>

<pre class="language-c"><code class="language-c">
const unsigned int crc16_table[256] = {
    0x0000, 0xc0c1, 0xc181, 0x0140, 0xc301, 0x03c0, 0x0280, 0xc241,
    0xc601, 0x06c0, 0x0780, 0xc741, 0x0500, 0xc5c1, 0xc481, 0x0440,
    0xcc01, 0x0cc0, 0x0d80, 0xcd41, 0x0f00, 0xcfc1, 0xce81, 0x0e40,
    0x0a00, 0xcac1, 0xcb81, 0x0b40, 0xc901, 0x09c0, 0x0880, 0xc841,
    0xd801, 0x18c0, 0x1980, 0xd941, 0x1b00, 0xdbc1, 0xda81, 0x1a40,
    0x1e00, 0xdec1, 0xdf81, 0x1f40, 0xdd01, 0x1dc0, 0x1c80, 0xdc41,
    0x1400, 0xd4c1, 0xd581, 0x1540, 0xd701, 0x17c0, 0x1680, 0xd641,
    0xd201, 0x12c0, 0x1380, 0xd341, 0x1100, 0xd1c1, 0xd081, 0x1040,
    0xf001, 0x30c0, 0x3180, 0xf141, 0x3300, 0xf3c1, 0xf281, 0x3240,
    0x3600, 0xf6c1, 0xf781, 0x3740, 0xf501, 0x35c0, 0x3480, 0xf441,
    0x3c00, 0xfcc1, 0xfd81, 0x3d40, 0xff01, 0x3fc0, 0x3e80, 0xfe41,
    0xfa01, 0x3ac0, 0x3b80, 0xfb41, 0x3900, 0xf9c1, 0xf881, 0x3840,
    0x2800, 0xe8c1, 0xe981, 0x2940, 0xeb01, 0x2bc0, 0x2a80, 0xea41,
    0xee01, 0x2ec0, 0x2f80, 0xef41, 0x2d00, 0xedc1, 0xec81, 0x2c40,
    0xe401, 0x24c0, 0x2580, 0xe541, 0x2700, 0xe7c1, 0xe681, 0x2640,
    0x2200, 0xe2c1, 0xe381, 0x2340, 0xe101, 0x21c0, 0x2080, 0xe041,
    0xa001, 0x60c0, 0x6180, 0xa141, 0x6300, 0xa3c1, 0xa281, 0x6240,
    0x6600, 0xa6c1, 0xa781, 0x6740, 0xa501, 0x65c0, 0x6480, 0xa441,
    0x6c00, 0xacc1, 0xad81, 0x6d40, 0xaf01, 0x6fc0, 0x6e80, 0xae41,
    0xaa01, 0x6ac0, 0x6b80, 0xab41, 0x6900, 0xa9c1, 0xa881, 0x6840,
    0x7800, 0xb8c1, 0xb981, 0x7940, 0xbb01, 0x7bc0, 0x7a80, 0xba41,
    0xbe01, 0x7ec0, 0x7f80, 0xbf41, 0x7d00, 0xbdc1, 0xbc81, 0x7c40,
    0xb401, 0x74c0, 0x7580, 0xb541, 0x7700, 0xb7c1, 0xb681, 0x7640,
    0x7200, 0xb2c1, 0xb381, 0x7340, 0xb101, 0x71c0, 0x7080, 0xb041,
    0x5000, 0x90c1, 0x9181, 0x5140, 0x9301, 0x53c0, 0x5280, 0x9241,
    0x9601, 0x56c0, 0x5780, 0x9741, 0x5500, 0x95c1, 0x9481, 0x5440,
    0x9c01, 0x5cc0, 0x5d80, 0x9d41, 0x5f00, 0x9fc1, 0x9e81, 0x5e40,
    0x5a00, 0x9ac1, 0x9b81, 0x5b40, 0x9901, 0x59c0, 0x5880, 0x9841,
    0x8801, 0x48c0, 0x4980, 0x8941, 0x4b00, 0x8bc1, 0x8a81, 0x4a40,
    0x4e00, 0x8ec1, 0x8f81, 0x4f40, 0x8d01, 0x4dc0, 0x4c80, 0x8c41,
    0x4400, 0x84c1, 0x8581, 0x4540, 0x8701, 0x47c0, 0x4680, 0x8641,
    0x8201, 0x42c0, 0x4380, 0x8341, 0x4100, 0x81c1, 0x8081, 0x4040,
};


unsigned short crc16_IBM(const unsigned char *ptr,int len)
{
    unsigned short crc = 0x0000;

    while(len--)
    {
        crc = (crc &gt;&gt; 8) ^ crc16_table[(crc ^ *ptr++) &amp; 0xff];
    }

    return (crc);
}

</code></pre>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/maixcdk/doc/zh/convention/i18n.html">
                            <span class="icon"></span>
                            <span class="label">I18N(国际化/多语言)</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/maixcdk/doc/zh/convention/nn.html">
                            <span class="label">NN AI 模型</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>相关链接</a><ul><li><a target="_blank" href="https://wiki.sipeed.com">Sipeed Wiki</a></li>
<li><a target="_blank" href="https://www.sipeed.com">Sipeed 官网</a></li>
<li><a target="_blank" href="https://maixhub.com/">MaixHub</a></li>
<li><a  href="/maixcdk/sitemap.xml">网站地图</a></li>
<li><a target="_blank" href="https://github.com/neutree/teedoc">网站使用 teedoc 生成</a></li>
</ul>
</li>
<li><a>源码</a><ul><li><a target="_blank" href="https://github.com/sipeed/maixpy">MaixPy 源码</a></li>
<li><a target="_blank" href="https://github.com/sipeed/MaixCDK">MaixCDK 源码</a></li>
<li><a target="_blank" href="https://github.com/sipeed/sipeed_wiki">Wiki 源码</a></li>
<li><a target="_blank" href="https://github.com/sipeed">开源项目</a></li>
</ul>
</li>
<li><a>关注我们</a><ul><li><a target="_blank" href="https://twitter.com/SipeedIO">twitter</a></li>
<li><a target="_blank" href="https://sipeed.taobao.com/">淘宝</a></li>
<li><a target="_blank" href="https://www.aliexpress.com/store/911876460">AliExpress</a></li>
<li><a target="_blank" href="https://github.com/sipeed">github</a></li>
<li><a><a>微信公众号</a><img src='/maixpy/static/image/wechat.png'></a>
</li>
</ul>
</li>
<li><a>联系我们</a><ul><li><a>电话: +86 0755-27808509</a>
</li>
<li><a>商业支持: support@sipeed.com</a>
</li>
<li><a>地址: 深圳市宝安区新湖路4008号蘅芳科技办公大厦A座-2101C</a>
</li>
<li><a  href="https://wiki.sipeed.com/join_us.html">加入我们</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://www.sipeed.com">©2018-2023 深圳矽速科技有限公司</a></li>
<li><a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index">粤ICP备19015433号</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/maixcdk/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/maixcdk/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/maixcdk/static/js/theme_default/main.js"></script>
    
        <script src="/maixcdk/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/maixcdk/static/css/theme_default/prism.min.js"></script>
    
        <script src="/maixcdk/static/js/search/search_main.js"></script>
    
        <script src="/maixcdk/static/js/custom.js"></script>
    
        <script src="/maixcdk/static/js/thumbs_up/main.js"></script>
    
</body>

</html>