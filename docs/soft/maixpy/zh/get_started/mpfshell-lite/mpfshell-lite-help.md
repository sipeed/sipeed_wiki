# Document

### Mpfshell 使用手册

由于本章涉及的内容不适合图示说明，所以均已表格或文字说明。

在 python3.5 以上使用命令 `pip install mpfshell-lite` 即可安装，接着输入 `mpfshell-lite` 即可打开运行。

![](./mpfshell_install.png)

##### 0. 了解不同的支持版本

| 系统类型 | 系统版本         | 运行情况 | 注意事项            |
| -------- | ---------------- | -------- | ------------------- |
| Windows  | WIN7 - WIN10     | 正常     | 原生 CMD 不支持 TAB |
| Linux    | Lubuntu - Ubuntu | 正常     | 原生 Shell 支持 TAB |
| Mac      | Darwin           | 正常     | 与 Unix 均一致      |



##### 1. 了解重要的功能操作

| 操作方法                      | 不同系统工具支持情况              | 运行效果                                                     | 注意事项                                                     |
| ----------------------------- | --------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 输入一些内容后通过 TAB 键补全 | 仅 shell、repl、powershell 支持。 | 如果想要打 import 只需要 输入 i 后在按下 TAB 键就可以自动补全了，比如 linux 下，输入 ttyUSB0，只需要 i + TAB 键就可以了。 | 前提是，该命令被系统提前输入过，否则它没办法补全，它只能补全历史输入的信息。 |
| 左键复制选取，右键粘贴选取    | 仅 Windows的系统支持。            | 开启 **CMD控制台** 程序的属性里的 **快速编辑** 功能，可以让程序支持鼠标 点击暂停程序后点左键拖动复制文本内容。 | 如果选取的是多行代码或命令，不代表可以直接使用，所以一般都是选取一行的。 |
| 上下左右按键及退格            | 均支持                            | 上下按键可以切换读取历史输入过的命令，左右方向键以及程序退格操作可以对自己输入过的内容进行修改。 | 仅针对windows做了修复。                                    |

##### 2. 了解所有功能的命令

| 命令类型     | 使用方法                                                     | 运行结果                                             | 注意事项                                                     |
| ------------ | ------------------------------------------------------------ | ---------------------------------------------------- | ------------------------------------------------------------ |
| open(o)      | 打开当前设备。格式有：有线串口 `open com3`，无线有 `ws:192.168.10.114,1234` | 连接成功后返回 `Connected to esp32`                  | 控制板子前，需要先打开连接。括号为简写。                     |
| close        | 关闭当前设备。                                               |                                                      |                                                              |
| quit         | 输入                                                             | 退出程序                                                   |                                                              |
| EOF          | 输入                                                         | 退出程序                                             | 无                                                           |
| cat          | 输入 文件名，例如 `cat boot.py`                              | 将板子的指定文件打印出来快速查看。                   | 无                                                           |
| put          | 把当前目录下的文件推送到板子，例如`put boot.py`              | 无                                                   | 失败会返回错误信息                                           |
| get          | 获取板子当前目录下的文件，例如`get boot.py`                  | 在程序运行的目录下多了一个 boot.py 文件              |                                                              |
| mput         | 与 put 相对，以板子为主，对程序的目录操作。                  |                                                      |                                                              |
| mget         | 与 get 相对，以板子为主，对程序的目录操作。                  |                                                      |                                                              |
| repl(e)      | 进入 python 的 repl 控制接口                                 | 可以直接执行python代码。                             |                                                              |
| exec (e)     | 输入 Python 代码，例如`exec print('hello')`                  | 返回print('hello')的运行结果 hello                   | 只能执行一行 python 代码。括号为简写。                       |
| execfile(ef) | 执行板子中存在的python文件，例如`execfile main.py`           | 执行 main.py 的效果                                  | 括号为简写。                                              |
| lexecfile(ef) | 执行程序下存在的python文件，例如`lexecfile main.py`           | 执行 main.py 的效果                                  | 括号为简写，与 runfile 不同的是会进入repl模式，所以支持input操作。                                              |
| runfile(rf)  | 结合了 put 和 execfile 命令                                  |                                                      | 括号为简写。                                                 |
| cd           | 输入 指定板子里的目录，例如 `cd /`                           | 修改程序访问板子的所处目录                           | 以 `/` 开头的linux路径，尽量不要改变路径，除非你十分清楚自己在做什么。 |
| md           | 输入 目录名称                                                | 在板子上新建一个目录                                 | 无                                                           |
| lcd          | 输入 指定现在程序里的目录，例如 `cd /`                       | 修改程序访问板子的所处目录                           | 以 `/` 开头的linux路径，尽量不要改变路径，除非你十分清楚自己在做什么。 |
| pwd          | 输入`pwd`                                                    | 返回当前板子所处的目录                               | 无                                                           |
| lpwd         | 输入 `lpwd`                                                  | 返回当前程序所处的目录                               | 无                                                           |
| mpyc         | 输入 当前目录下的 python 文件，例如 `mpyc main.py`           | 把 python 代码 pyc 化静态编译代码处理，生成 main.pyc |                                                              |
| mrm          | 输入程序当前的 `rm 目录或文件名`                                     | 移除该目录或文件名                                           |                                                              |
| rm           | 输入板子当前的 `rm 目录或文件名`                                     | 移除该目录或文件名                                           |                                                              |
| ls           | 输入` ls /`                                                  | 查看 板子 当前目录下的所有文件                       |                                                              |
| lls          | 输入 `lls /`                                                 | 查看 程序 当前目录下的所有文件                       |                                                              |
| view          | 输入 `view`                                                 | 查看 本机 可能的串口，和当前的 open 配置                       |                                                              |
| help         | 查看命令的帮助，详细看本节结尾。                             |                                                      |                                                              |

在程序中，你也可以通过 help + 命令 的方式获取对应的命令说明或参数等细节。

例如：`help cd`， 返回的是 `cd <TARGET DIR>
​        Change current remote directory to given target.`。

可以得知 它是用来改变 目标板子里的当前文件目录起点，相当于设置板子的文件夹默认路径在什么位置。

提示：连接板子的时候，要特别注意死循环，如果在连接过程中板子存在没有任何延时的死循环，则会影响软件连接板子的成功率，尤其是没有延时的 mian.py 死循环，这会导致上电后将无法连接无线模式，这点需要注意，不过，有线串口的连接不成功则会进行板子的复位。
